fpin<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–ò–≥—Ä–∞ ‚Ä¢ –ü—Ä–∏–∑–Ω–∞–∫–∏ –¥–µ–ª–∏–º–æ—Å—Ç–∏ (2, 3, 5, 9, 10)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:wght@500;700;800&family=Rubik:wght@500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg: #fbf7f4;
        --card: #ffffff;
        --ink: #2b2b2f;
        --mute: #6b6b76;
        --pin1: #f6b8b8;
        --pin2: #b8e1dd;
        --pin3: #c9c3f2;
        --pin4: #ffe49d;
        --pin5: #b7d3ff;
        --ok: #2fb47c;
        --bad: #f05454;
        --accent: #8b82f6;
        --shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
        --radius: 22px;
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        background: radial-gradient(
            1000px 500px at -10% -10%,
            #fff,
            transparent
          ),
          radial-gradient(700px 400px at 110% 10%, #fff, transparent),
          linear-gradient(180deg, #fff 0%, var(--bg) 100%);
        color: var(--ink);
        font-family: "Nunito", system-ui, -apple-system, Segoe UI, Roboto, Arial,
          sans-serif;
        line-height: 1.45;
      }
      .wrap {
        max-width: 1100px;
        padding: 28px 20px 80px;
        margin: 0 auto;
      }
      header {
        display: grid;
        gap: 14px;
        justify-items: center;
        text-align: center;
        margin-bottom: 18px;
      }
      .title {
        font-family: "Rubik", "Nunito", sans-serif;
        font-weight: 800;
        letter-spacing: 0.3px;
        font-size: clamp(28px, 4.5vw, 44px);
        display: inline-grid;
        gap: 8px;
      }
      .title span.badge {
        place-self: center;
        font-size: 12px;
        font-weight: 800;
        letter-spacing: 0.6px;
        text-transform: uppercase;
        color: #3f3f46;
        background: linear-gradient(90deg, var(--pin2), var(--pin5));
        padding: 6px 10px;
        border-radius: 999px;
        box-shadow: var(--shadow);
      }
      .subtitle {
        color: var(--mute);
        max-width: 700px;
      }
      .tabs {
        display: flex;
        gap: 8px;
        margin: 8px auto 20px;
        justify-content: center;
        flex-wrap: wrap;
      }
      .tab {
        border: none;
        background: #fff;
        padding: 10px 14px;
        border-radius: 999px;
        cursor: pointer;
        box-shadow: var(--shadow);
        font-weight: 700;
        transition: 0.2s transform, 0.2s box-shadow;
      }
      .tab[aria-selected="true"] {
        background: linear-gradient(90deg, var(--pin3), var(--pin4));
      }
      .tab:hover {
        transform: translateY(-1px);
      }
      .section {
        display: none;
      }
      .section.active {
        display: block;
      }
      .board {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 18px;
        align-items: start;
      }
      @media (max-width: 880px) {
        .board {
          grid-template-columns: 1fr;
        }
      }
      .card {
        background: var(--card);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 18px;
        position: relative;
        overflow: hidden;
      }
      .card h3 {
        margin: 0 0 8px;
        font-size: 20px;
      }
      .card .hint {
        color: var(--mute);
        font-size: 14px;
      }
      .pin {
        position: absolute;
        width: 34px;
        height: 34px;
        border-radius: 10px;
        transform: rotate(10deg);
        top: -10px;
        right: 14px;
        box-shadow: 0 6px 14px rgba(0, 0, 0, 0.12);
      }
      .pin.p1 {
        background: var(--pin1);
      }
      .pin.p2 {
        background: var(--pin2);
      }
      .pin.p3 {
        background: var(--pin3);
      }
      .tiles {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-top: 8px;
      }
      .tile {
        user-select: none;
        background: linear-gradient(160deg, var(--pin5), var(--pin2));
        color: #0f172a;
        padding: 14px 16px;
        min-width: 64px;
        text-align: center;
        font-weight: 900;
        border-radius: 16px;
        box-shadow: var(--shadow);
        cursor: grab;
        font-size: 22px;
        transition: 0.15s transform, 0.2s box-shadow, 0.2s background;
      }
      .tile:active {
        cursor: grabbing;
        transform: scale(0.98);
      }
      .tile.picked {
        outline: 3px solid var(--accent);
        transform: translateY(-1px);
      }
      .rules {
        display: grid;
        gap: 12px;
      }
      .rule-card {
        position: relative;
        border: 2px dashed #e5e7eb;
        border-radius: 18px;
        padding: 14px 14px 14px 48px;
        min-height: 72px;
        display: grid;
        align-content: center;
        transition: 0.2s;
      }
      .rule-card .num {
        position: absolute;
        left: 8px;
        top: 10px;
        width: 28px;
        height: 28px;
        border-radius: 8px;
        display: grid;
        place-items: center;
        font-weight: 900;
        color: #0f172a;
        background: #e9ecff;
      }
      .rule-card .text {
        font-weight: 700;
      }
      .rule-card .sub {
        font-size: 12px;
        color: var(--mute);
      }
      .rule-card.ready {
        border-color: rgba(47, 180, 124, 0.35);
        background: linear-gradient(
          0deg,
          rgba(47, 180, 124, 0.07),
          transparent
        );
      }
      .rule-card.good {
        border-color: var(--ok);
        background: linear-gradient(0deg, rgba(47, 180, 124, 0.12), #fff);
      }
      .rule-card.bad {
        border-color: var(--bad);
        background: linear-gradient(0deg, rgba(240, 84, 84, 0.12), #fff);
      }
      .actions {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 12px;
      }
      .btn {
        border: none;
        background: #111827;
        color: #fff;
        padding: 12px 14px;
        border-radius: 14px;
        font-weight: 800;
        cursor: pointer;
        box-shadow: var(--shadow);
        transition: 0.2s transform;
      }
      .btn:hover {
        transform: translateY(-1px);
      }
      .btn.ghost {
        background: #fff;
        color: #111827;
        border: 2px solid #e5e7eb;
      }
      .btn.ok {
        background: var(--ok);
      }
      .toast {
        margin-top: 10px;
        background: linear-gradient(90deg, var(--pin1), var(--pin4));
        padding: 10px 12px;
        border-radius: 12px;
        font-weight: 800;
        display: inline-block;
      }
      .practice {
        display: grid;
        gap: 18px;
      }
      .practice-head {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }
      .number {
        font-size: clamp(36px, 6vw, 64px);
        font-weight: 900;
        letter-spacing: 1px;
        background: linear-gradient(90deg, var(--pin3), var(--pin5));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }
      .score {
        font-weight: 800;
        color: #374151;
      }
      .progress {
        height: 10px;
        background: #eee;
        border-radius: 999px;
        overflow: hidden;
      }
      .progress > div {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, var(--pin2), var(--pin5));
        transition: width 0.4s ease;
      }
      .chips {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }
      .chip {
        border: 2px solid #e5e7eb;
        background: #fff;
        padding: 10px 12px;
        border-radius: 999px;
        font-weight: 800;
        cursor: pointer;
        transition: 0.15s background, 0.15s transform;
      }
      .chip[aria-pressed="true"] {
        background: linear-gradient(90deg, var(--pin1), var(--pin3));
      }
      .chip.good {
        outline: 3px solid rgba(47, 180, 124, 0.6);
      }
      .chip.bad {
        outline: 3px solid rgba(240, 84, 84, 0.6);
      }
      .explain {
        display: grid;
        gap: 10px;
      }
      .explain .item {
        background: #fff;
        padding: 12px;
        border-radius: 12px;
        border: 1px solid #eee;
      }
      .explain .item.good {
        border-color: rgba(47, 180, 124, 0.5);
      }
      .explain .item.bad {
        border-color: rgba(240, 84, 84, 0.5);
      }
      .confetti {
        position: fixed;
        top: -10px;
        width: 10px;
        height: 14px;
        opacity: 0.9;
        pointer-events: none;
        z-index: 99;
      }
      @keyframes fall {
        to {
          transform: translateY(110vh) rotate(720deg);
        }
      }
      .sticker {
        position: fixed;
        right: 14px;
        bottom: 14px;
        background: #fff;
        border-radius: 16px;
        padding: 8px 12px;
        box-shadow: var(--shadow);
        font-weight: 900;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <header>
        <div class="title">
          <span class="badge">–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ ‚Ä¢ –∏–≥—Ä–∞</span>
          –ü—Ä–∏–∑–Ω–∞–∫–∏ –¥–µ–ª–∏–º–æ—Å—Ç–∏: 2, 3, 5, 9, 10
        </div>
        <div class="subtitle">
          –°–Ω–∞—á–∞–ª–∞ —Å–æ–µ–¥–∏–Ω–∏ —á–∏—Å–ª–∞ —Å –∏—Ö –ø—Ä–∞–≤–∏–ª–∞–º–∏ üëá –ê –ø–æ—Ç–æ–º –ø–æ—Ç—Ä–µ–Ω–∏—Ä—É–π—Å—è
          –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, –Ω–∞ —á—Ç–æ –¥–µ–ª–∏—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ‚ú®
        </div>
        <div class="tabs" role="tablist">
          <button
            class="tab"
            role="tab"
            id="tab-match"
            aria-selected="true"
            aria-controls="panel-match"
          >
            1) –°–æ–µ–¥–∏–Ω—è–µ–º
          </button>
          <button
            class="tab"
            role="tab"
            id="tab-practice"
            aria-selected="false"
            aria-controls="panel-practice"
            disabled
            title="–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–π–¥–∏ —à–∞–≥ 1"
          >
            2) –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞
          </button>
        </div>
      </header>

      <section
        id="panel-match"
        class="section active"
        role="tabpanel"
        aria-labelledby="tab-match"
      >
        <div class="board">
          <div class="card" id="leftCard">
            <div class="pin p1"></div>
            <h3>–õ–µ–≤—ã–π —Å—Ç–æ–ª–±–∏–∫: –ß–ò–°–õ–ê</h3>
            <div class="hint">
              –ü–µ—Ä–µ—Ç–∞—â–∏ —á–∏—Å–ª–æ –∫ –ø—Ä–∞–≤–∏–ª—É. –ú–æ–∂–Ω–æ –∏ —Ç–∞–ø–æ–º: –≤—ã–±–µ—Ä–∏ —á–∏—Å–ª–æ, –∑–∞—Ç–µ–º
              –∫–∞—Ä—Ç–æ—á–∫—É –ø—Ä–∞–≤–∏–ª–∞.
            </div>
            <div class="tiles" id="tiles"></div>
            <div class="actions">
              <button class="btn ghost" id="resetMatch">–°–±—Ä–æ—Å–∏—Ç—å</button>
            </div>
          </div>
          <div class="card">
            <div class="pin p2"></div>
            <h3>–ü—Ä–∞–≤—ã–π —Å—Ç–æ–ª–±–∏–∫: –ü–†–ê–í–ò–õ–ê</h3>
            <div class="hint">
              –ü–æ–¥—Å–∫–∞–∑–∫–∏ ‚Äî –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–µ–∫. –ö–æ–≥–¥–∞ –≤—Å—ë —Å–æ–≤–ø–∞–¥—ë—Ç, –æ—Ç–∫—Ä–æ–µ—Ç—Å—è
              —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞.
            </div>
            <div class="rules" id="rules"></div>
            <div id="matchToast" class="toast" style="display: none">
              –£—Ä–∞! –í—Å—ë –≤–µ—Ä–Ω–æ üéâ –¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ ¬´–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ¬ª
            </div>
            <div class="actions">
              <button class="btn ok" id="goPractice" disabled>
                –ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ ‚Üí
              </button>
            </div>
          </div>
        </div>
      </section>

      <section
        id="panel-practice"
        class="section"
        role="tabpanel"
        aria-labelledby="tab-practice"
      >
        <div class="card practice">
          <div class="pin p3"></div>
          <div class="practice-head">
            <div class="number" id="theNumber">‚Äì</div>
            <div class="score" id="scoreBox">–°—á—ë—Ç: 0/0 ‚Ä¢ –°–µ—Ä–∏—è: 0</div>
          </div>
          <div class="progress"><div id="progressBar"></div></div>
          <div>
            <h3>–í—ã–±–µ—Ä–∏, –Ω–∞ –∫–∞–∫–∏–µ —á–∏—Å–ª–∞ –¥–µ–ª–∏—Ç—Å—è —ç—Ç–æ —á–∏—Å–ª–æ:</h3>
            <div class="chips" id="chips"></div>
          </div>
          <div class="actions">
            <button class="btn" id="checkBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
            <button class="btn ghost" id="nextBtn">–ù–æ–≤–æ–µ —á–∏—Å–ª–æ</button>
            <button class="btn ghost" id="hintBtn">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
          </div>
          <div class="explain" id="explain"></div>
        </div>
        <div class="card" style="margin-top: 16px">
          <h3>–¢–µ–æ—Ä–∏—è –∫–æ—Ä–æ—Ç–∫–æ üìå</h3>
          <ul>
            <li>
              <b>–î–µ–ª–∏–º–æ—Å—Ç—å –Ω–∞ 2</b>: –ø–æ—Å–ª–µ–¥–Ω—è—è —Ü–∏—Ñ—Ä–∞ —á—ë—Ç–Ω–∞—è (0, 2, 4, 6, 8).
            </li>
            <li><b>–î–µ–ª–∏–º–æ—Å—Ç—å –Ω–∞ 3</b>: —Å—É–º–º–∞ —Ü–∏—Ñ—Ä –¥–µ–ª–∏—Ç—Å—è –Ω–∞ 3.</li>
            <li><b>–î–µ–ª–∏–º–æ—Å—Ç—å –Ω–∞ 5</b>: –ø–æ—Å–ª–µ–¥–Ω—è—è —Ü–∏—Ñ—Ä–∞ 0 –∏–ª–∏ 5.</li>
            <li><b>–î–µ–ª–∏–º–æ—Å—Ç—å –Ω–∞ 9</b>: —Å—É–º–º–∞ —Ü–∏—Ñ—Ä –¥–µ–ª–∏—Ç—Å—è –Ω–∞ 9.</li>
            <li><b>–î–µ–ª–∏–º–æ—Å—Ç—å –Ω–∞ 10</b>: –ø–æ—Å–ª–µ–¥–Ω—è—è —Ü–∏—Ñ—Ä–∞ 0.</li>
          </ul>
        </div>
      </section>
    </div>
    <div class="sticker">üåü –£–¥–∞—á–∏!</div>

    <script>
      const rulesData = [
        {
          n: 2,
          text: "–ß—ë—Ç–Ω–∞—è –ø–æ—Å–ª–µ–¥–Ω—è—è —Ü–∏—Ñ—Ä–∞ (0, 2, 4, 6, 8)",
          tip: "–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é —Ü–∏—Ñ—Ä—É.",
        },
        { n: 3, text: "–°—É–º–º–∞ —Ü–∏—Ñ—Ä –∫—Ä–∞—Ç–Ω–∞ 3", tip: "–°–ª–æ–∂–∏ –≤—Å–µ —Ü–∏—Ñ—Ä—ã." },
        { n: 5, text: "–ü–æ—Å–ª–µ–¥–Ω—è—è —Ü–∏—Ñ—Ä–∞ 0 –∏–ª–∏ 5", tip: "–•–≤–æ—Å—Ç–∏–∫ ‚Äî 0 –∏–ª–∏ 5?" },
        { n: 9, text: "–°—É–º–º–∞ —Ü–∏—Ñ—Ä –∫—Ä–∞—Ç–Ω–∞ 9", tip: "–°–ª–æ–∂–∏ –≤—Å–µ —Ü–∏—Ñ—Ä—ã." },
        {
          n: 10,
          text: "–ü–æ—Å–ª–µ–¥–Ω—è—è —Ü–∏—Ñ—Ä–∞ 0",
          tip: "–ù–æ–ª—å –≤ –∫–æ–Ω—Ü–µ ‚Äî –¥–µ–ª–∏—Ç—Å—è –Ω–∞ 10!",
        },
      ];

      const $ = (sel) => document.querySelector(sel);
      const $$ = (sel) => Array.from(document.querySelectorAll(sel));
      const shuffle = (arr) => arr.sort(() => Math.random() - 0.5);

      const tabMatch = $("#tab-match");
      const tabPractice = $("#tab-practice");
      const panelMatch = $("#panel-match");
      const panelPractice = $("#panel-practice");
      function activateTab(which) {
        if (which === "match") {
          tabMatch.setAttribute("aria-selected", "true");
          tabPractice.setAttribute("aria-selected", "false");
          panelMatch.classList.add("active");
          panelPractice.classList.remove("active");
        } else {
          tabMatch.setAttribute("aria-selected", "false");
          tabPractice.setAttribute("aria-selected", "true");
          panelPractice.classList.add("active");
          panelMatch.classList.remove("active");
        }
      }
      tabMatch.addEventListener("click", () => activateTab("match"));
      tabPractice.addEventListener("click", () => {
        if (!tabPractice.disabled) activateTab("practice");
      });

      const tilesBox = $("#tiles");
      const rulesBox = $("#rules");
      const resetMatchBtn = $("#resetMatch");
      const goPracticeBtn = $("#goPractice");
      const matchToast = $("#matchToast");
      let selectedTile = null;

      function renderMatch() {
        tilesBox.innerHTML = "";
        rulesBox.innerHTML = "";
        selectedTile = null;
        goPracticeBtn.disabled = true;
        matchToast.style.display = "none";
        const nums = shuffle(rulesData.map((r) => r.n));
        nums.forEach((n) => {
          const t = document.createElement("div");
          t.className = "tile";
          t.draggable = true;
          t.textContent = n;
          t.dataset.n = n;
          t.addEventListener("dragstart", (e) => {
            e.dataTransfer.setData("text/plain", String(n));
          });
          t.addEventListener("click", () => {
            if (selectedTile === t) {
              t.classList.remove("picked");
              selectedTile = null;
              return;
            }
            $$(".tile").forEach((x) => x.classList.remove("picked"));
            t.classList.add("picked");
            selectedTile = t;
          });
          tilesBox.appendChild(t);
        });
        shuffle([...rulesData]).forEach((rule) => {
          const card = document.createElement("div");
          card.className = "rule-card";
          card.dataset.target = rule.n;
          card.innerHTML = `<div class="num">?</div><div class="text">${rule.text}</div><div class="sub">${rule.tip}</div>`;
          card.addEventListener("dragover", (e) => {
            e.preventDefault();
            card.classList.add("ready");
          });
          card.addEventListener("dragleave", () =>
            card.classList.remove("ready")
          );
          card.addEventListener("drop", (e) => {
            e.preventDefault();
            card.classList.remove("ready");
            const n = Number(e.dataTransfer.getData("text/plain"));
            tryPlace(card, n);
          });
          card.addEventListener("click", () => {
            if (!selectedTile) return;
            const n = Number(selectedTile.dataset.n);
            tryPlace(card, n);
          });
          rulesBox.appendChild(card);
        });
      }

      function tryPlace(card, n) {
        const target = Number(card.dataset.target);
        const tile = $(`.tile[data-n="${n}"]`);
        if (!tile) return;
        if (card.classList.contains("good")) return;
        if (n === target) {
          card.classList.remove("bad");
          card.classList.add("good");
          card.querySelector(".num").textContent = n;
          tile.remove();
          selectedTile = null;
          confetti(24);
        } else {
          card.classList.add("bad");
          setTimeout(() => card.classList.remove("bad"), 500);
          tile.animate(
            [
              { transform: "translateX(0)" },
              { transform: "translateX(-6px)" },
              { transform: "translateX(6px)" },
              { transform: "translateX(0)" },
            ],
            { duration: 250 }
          );
        }
        checkAllMatched();
      }

      function checkAllMatched() {
        const allGood = $$(".rule-card").every((c) =>
          c.classList.contains("good")
        );
        if (allGood) {
          goPracticeBtn.disabled = false;
          matchToast.style.display = "inline-block";
        }
      }

      resetMatchBtn.addEventListener("click", renderMatch);
      goPracticeBtn.addEventListener("click", () => {
        tabPractice.disabled = false;
        activateTab("practice");
      });

      const chipsBox = $("#chips");
      const numberEl = $("#theNumber");
      const explainBox = $("#explain");
      const scoreBox = $("#scoreBox");
      const progressBar = $("#progressBar");
      const checkBtn = $("#checkBtn");
      const nextBtn = $("#nextBtn");
      const hintBtn = $("#hintBtn");
      const order = [2, 3, 5, 9, 10];
      let current = 0;
      let score = 0,
        total = 0,
        streak = 0;

      function renderChips() {
        chipsBox.innerHTML = "";
        order.forEach((n) => {
          const b = document.createElement("button");
          b.className = "chip";
          b.type = "button";
          b.textContent = `–¥–µ–ª–∏—Ç—Å—è –Ω–∞ ${n}`;
          b.dataset.n = n;
          b.setAttribute("aria-pressed", "false");
          b.addEventListener("click", () => {
            const pressed = b.getAttribute("aria-pressed") === "true";
            b.setAttribute("aria-pressed", String(!pressed));
          });
          chipsBox.appendChild(b);
        });
      }

      function randInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }
      function sumDigits(n) {
        return Math.abs(n)
          .toString()
          .split("")
          .reduce((s, d) => s + Number(d), 0);
      }

      function newNumber() {
        let n;
        for (let i = 0; i < 20; i++) {
          n = randInt(2, 9999);
          const good = [2, 3, 5, 9, 10].some((k) => n % k === 0);
          if (good) break;
        }
        current = n;
        numberEl.textContent = n.toLocaleString("ru-RU");
        explainBox.innerHTML = "";
        $$(".chip").forEach((c) => {
          c.setAttribute("aria-pressed", "false");
          c.classList.remove("good", "bad");
        });
        checkBtn.disabled = false;
      }

      function groundTruth(n) {
        return {
          2: n % 2 === 0,
          3: n % 3 === 0,
          5: n % 5 === 0,
          9: sumDigits(n) % 9 === 0,
          10: n % 10 === 0,
        };
      }

      function explainFor(n) {
        return {
          2: `–ü–æ—Å–ª–µ–¥–Ω—è—è —Ü–∏—Ñ—Ä–∞ ${String(n).slice(-1)} ‚Äî ${
            [0, 2, 4, 6, 8].includes(Number(String(n).slice(-1)))
              ? "—á—ë—Ç–Ω–∞—è"
              : "–Ω–µ—á—ë—Ç–Ω–∞—è"
          }.`,
          3: `–°—É–º–º–∞ —Ü–∏—Ñ—Ä ${String(n).split("").join(" + ")} = ${sumDigits(n)} ${
            sumDigits(n) % 3 === 0 ? "–∫—Ä–∞—Ç–Ω–∞ 3" : "–Ω–µ –∫—Ä–∞—Ç–Ω–∞ 3"
          }.`,
          5: `–ü–æ—Å–ª–µ–¥–Ω—è—è —Ü–∏—Ñ—Ä–∞ ${String(n).slice(-1)} ‚Äî ${
            ["0", "5"].includes(String(n).slice(-1))
              ? "0/5, –ø–æ–¥—Ö–æ–¥–∏—Ç"
              : "–Ω–µ 0 –∏ –Ω–µ 5"
          }.`,
          9: `–°—É–º–º–∞ —Ü–∏—Ñ—Ä ${String(n).split("").join(" + ")} = ${sumDigits(n)} ${
            sumDigits(n) % 9 === 0 ? "–∫—Ä–∞—Ç–Ω–∞ 9" : "–Ω–µ –∫—Ä–∞—Ç–Ω–∞ 9"
          }.`,
          10: `–ü–æ—Å–ª–µ–¥–Ω—è—è —Ü–∏—Ñ—Ä–∞ ${String(n).slice(-1)} ${
            n % 10 === 0 ? "—Ä–∞–≤–Ω–∞ 0" : "–Ω–µ —Ä–∞–≤–Ω–∞ 0"
          }.`,
        };
      }

      function updateScoreUI() {
        scoreBox.textContent = `–°—á—ë—Ç: ${score}/${total} ‚Ä¢ –°–µ—Ä–∏—è: ${streak}`;
        const pct = total ? Math.round((score / Math.max(total, 1)) * 100) : 0;
        progressBar.style.width = pct + "%";
      }

      checkBtn.addEventListener("click", () => {
        const truth = groundTruth(current);
        const selected = $$(".chip")
          .filter((c) => c.getAttribute("aria-pressed") === "true")
          .map((c) => Number(c.dataset.n));
        const should = order.filter((n) => truth[n]);
        const correct =
          selected.length === should.length && selected.every((n) => truth[n]);
        total++;
        if (correct) {
          score++;
          streak++;
          confetti(36);
        } else {
          streak = 0;
        }
        updateScoreUI();
        $$(".chip").forEach((ch) => {
          const n = Number(ch.dataset.n);
          ch.classList.remove("good", "bad");
          if (truth[n] && selected.includes(n)) ch.classList.add("good");
          else if (truth[n] && !selected.includes(n)) ch.classList.add("bad");
          else if (!truth[n] && selected.includes(n)) ch.classList.add("bad");
        });
        explainBox.innerHTML = "";
        const ex = explainFor(current);
        order.forEach((n) => {
          const div = document.createElement("div");
          div.className = "item " + (truth[n] ? "good" : "bad");
          div.innerHTML = `<b>–ü—Ä–∞–≤–∏–ª–æ ${n}:</b> ${ex[n]}`;
          explainBox.appendChild(div);
        });
        checkBtn.disabled = true;
      });

      nextBtn.addEventListener("click", newNumber);

      hintBtn.addEventListener("click", () => {
        const truth = groundTruth(current);
        const candidates = order.filter((n) => truth[n]);
        const already = $$(".chip")
          .filter((c) => c.getAttribute("aria-pressed") === "true")
          .map((c) => Number(c.dataset.n));
        const toHint = candidates.find((n) => !already.includes(n));
        if (toHint) {
          const chip = $(`.chip[data-n="${toHint}"]`);
          chip.setAttribute("aria-pressed", "true");
          chip.animate(
            [
              { transform: "scale(1)" },
              { transform: "scale(1.08)" },
              { transform: "scale(1)" },
            ],
            { duration: 260 }
          );
        } else {
          $$(".chip").forEach((c) =>
            c.animate(
              [
                { transform: "translateY(0)" },
                { transform: "translateY(-4px)" },
                { transform: "translateY(0)" },
              ],
              { duration: 200 }
            )
          );
        }
      });

      function confetti(count = 24) {
        const colors = [
          "var(--pin1)",
          "var(--pin2)",
          "var(--pin3)",
          "var(--pin4)",
          "var(--pin5)",
        ];
        for (let i = 0; i < count; i++) {
          const c = document.createElement("div");
          c.className = "confetti";
          c.style.left = Math.random() * 100 + "vw";
          c.style.background = colors[i % colors.length];
          c.style.transform = `rotate(${Math.random() * 360}deg)`;
          c.style.animation = `fall ${2.8 + Math.random() * 1.6}s linear`;
          document.body.appendChild(c);
          setTimeout(() => c.remove(), 4500);
        }
      }

      renderMatch();
      renderChips();
      newNumber();
    </script>
  </body>
</html>
